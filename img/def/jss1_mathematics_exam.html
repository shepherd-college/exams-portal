
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSS1 Mathematics Examination</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
       
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
       
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
       
        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 20px;
        }
       
        .school-logo {
            width: 120px;
            height: 120px;
            margin: 0 auto 15px;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid #3498db;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: white;
        }
       
        .school-logo img {
            max-width: 100%;
            max-height: 100%;
        }
       
        .exam-info {
            margin-bottom: 20px;
            background-color: #e8f4fc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
       
        .student-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
       
        .student-image {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid #3498db;
        }
       
        .student-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
       
        .timer {
            background-color: #2c3e50;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
        }
       
        .question-counter {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background-color: white;
            padding: 10px 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
       
        .question-container {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
       
        .question-number {
            font-size: 1.2rem;
            font-weight: bold;
            color: #3498db;
            margin-bottom: 15px;
        }
       
        .question-text {
            font-size: 1.1rem;
            margin-bottom: 20px;
        }
       
        .question-image {
            max-width: 100%;
            margin: 15px 0;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
       
        .options {
            margin-left: 20px;
        }
       
        .option {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
       
        .option:hover {
            background-color: #f0f8ff;
        }
       
        .option.selected {
            background-color: #e1f5fe;
            border-left: 4px solid #3498db;
        }
       
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
       
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
       
        .btn-prev {
            background-color: #95a5a6;
            color: white;
        }
       
        .btn-prev:hover {
            background-color: #7f8c8d;
        }
       
        .btn-next {
            background-color: #3498db;
            color: white;
        }
       
        .btn-next:hover {
            background-color: #2980b9;
        }
       
        .btn-submit {
            background-color: #2ecc71;
            color: white;
            display: none;
        }
       
        .btn-submit:hover {
            background-color: #27ae60;
        }
       
        .question-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
       
        .question-btn {
            width: 50px;
            height: 50px;
            border-radius: 5px;
            border: 1px solid #ddd;
            background-color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.2s;
        }
       
        .question-btn:hover {
            background-color: #f0f0f0;
        }
       
        .question-btn.answered {
            background-color: #3498db;
            color: white;
            border-color: #3498db;
        }
       
        .question-btn.current {
            border: 2px solid #e74c3c;
        }
       
        .html-editor {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            font-family: monospace;
            white-space: pre-wrap;
            overflow-x: auto;
            display: none;
        }
       
        .toggle-editor {
            background-color: #34495e;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
       
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
       
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
       
        .modal h2 {
            color: #2c3e50;
            margin-bottom: 20px;
        }
       
        .modal-score {
            font-size: 3rem;
            font-weight: bold;
            color: #2ecc71;
            margin: 20px 0;
        }
       
        .modal-details {
            text-align: left;
            margin: 20px 0;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
        }
       
        .modal-details p {
            margin: 8px 0;
        }
       
        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
       
        .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
        }
       
        .modal-btn-close {
            background-color: #95a5a6;
            color: white;
        }
       
        .modal-btn-close:hover {
            background-color: #7f8c8d;
        }
       
        .modal-btn-result {
            background-color: #3498db;
            color: white;
        }
       
        .modal-btn-result:hover {
            background-color: #2980b9;
        }
       
        .loading {
            text-align: center;
            padding: 20px;
            font-size: 1.2rem;
            color: #3498db;
        }
       
        .error {
            text-align: center;
            padding: 20px;
            background-color: #e74c3c;
            color: white;
            border-radius: 5px;
            margin: 20px 0;
        }
       
        @media (max-width: 768px) {
            .student-info {
                flex-direction: column;
                text-align: center;
            }
           
            .question-grid {
                grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
            }
           
            .question-btn {
                width: 40px;
                height: 40px;
            }
           
            .modal-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="school-logo">
                <img src="IMG/school_logo.png" alt="School Logo" id="school-logo-img" onerror="this.style.display='none'">
            </div>
            <h1 id="exam-title">JSS1 MATHEMATICS EXAMINATION</h1>
        </header>
       
        <div class="exam-info">
            <h2>Examination Details</h2>
            <p><strong>Class:</strong> <span id="class-info">JSS1</span></p>
            <p><strong>Subject:</strong> <span id="subject-info">Mathematics</span></p>
            <p><strong>Term:</strong> <span id="term-info">First Term</span></p>
            <p><strong>Session:</strong> <span id="session-info">2023/2024</span></p>
        </div>
       
        <div class="student-info">
            <div class="student-image">
                <img src="IMG/student.jpg" alt="Student Photo" id="student-img" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiMzNDk4REIiLz4KPHN2ZyB4PSIyMCIgeT0iMjAiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIiBmaWxsPSJub25lIj4KPHBhdGggZD0iTTIwIDBDMTcuOCAwIDE2IDEuOCAxNiA0QzE2IDYuMiAxNy44IDggMjAgOEMyMi4yIDggMjQgNi4yIDI0IDRDMjQgMS44IDIyLjIgMCAyMCAwWk0yMCA0MEMxMy40IDQwIDggMzQuNiA4IDI4QzggMjEuNCAxMy40IDE2IDIwIDE2QzI2LjYgMTYgMzIgMjEuNCAzMiAyOEMzMiAzNC42IDI2LjYgNDAgMjAgNDBaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4KPC9zdmc+'">
            </div>
            <div>
                <h3>Student Name: <span id="student-name">John Doe</span></h3>
                <p>Registration No: <span id="reg-no">JSS1/2023/001</span></p>
            </div>
        </div>
       
        <div class="timer">
            Time Remaining: <span id="time-display">60:00</span>
        </div>
       
        <div class="question-counter">
            <div>Total Questions: <span id="total-questions">0</span></div>
            <div>Answered: <span id="answered-count">0</span></div>
            <div>Unanswered: <span id="unanswered-count">0</span></div>
        </div>
       
        <div class="question-container">
            <div class="question-number">Question <span id="current-question">1</span></div>
            <div class="question-text" id="question-text"></div>
            <img id="question-image" class="question-image" src="" alt="" style="display: none;" onerror="this.style.display='none'">
            <div class="options" id="options-container"></div>
           
            <div class="navigation">
                <button class="btn btn-prev" id="prev-btn">Previous</button>
                <button class="btn btn-next" id="next-btn">Next</button>
                <button class="btn btn-submit" id="submit-btn">Submit Exam</button>
            </div>
        </div>
       
        <div class="question-grid" id="question-grid"></div>
       
        <button class="toggle-editor" id="toggle-editor">Show HTML Code</button>
        <div class="html-editor" id="html-editor"></div>
    </div>

    <!-- Modal for displaying results -->
    <div class="modal" id="result-modal">
        <div class="modal-content">
            <h2>Exam Results</h2>
            <div class="modal-score" id="modal-score">0/0</div>
            <div class="modal-details">
                <p><strong>Student Name:</strong> <span id="modal-student-name">John Doe</span></p>
                <p><strong>Class:</strong> <span id="modal-class">JSS1</span></p>
                <p><strong>Subject:</strong> <span id="modal-subject">Mathematics</span></p>
                <p><strong>Term:</strong> <span id="modal-term">First Term</span></p>
                <p><strong>Session:</strong> <span id="modal-session">2023/2024</span></p>
                <p><strong>Time Taken:</strong> <span id="modal-time-taken">00:00</span></p>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-close" id="modal-close-btn">Close</button>
                <button class="modal-btn modal-btn-result" id="modal-result-btn">View Detailed Results</button>
            </div>
        </div>
    </div>

    <script>
        // DOM elements
        const classInfo = document.getElementById('class-info');
        const subjectInfo = document.getElementById('subject-info');
        const termInfo = document.getElementById('term-info');
        const sessionInfo = document.getElementById('session-info');
        const timeDisplay = document.getElementById('time-display');
        const totalQuestions = document.getElementById('total-questions');
        const answeredCount = document.getElementById('answered-count');
        const unansweredCount = document.getElementById('unanswered-count');
        const currentQuestion = document.getElementById('current-question');
        const questionText = document.getElementById('question-text');
        const questionImage = document.getElementById('question-image');
        const optionsContainer = document.getElementById('options-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const questionGrid = document.getElementById('question-grid');
        const toggleEditor = document.getElementById('toggle-editor');
        const htmlEditor = document.getElementById('html-editor');
        const schoolLogoImg = document.getElementById('school-logo-img');
        const studentImg = document.getElementById('student-img');
        const studentName = document.getElementById('student-name');
        const examTitle = document.getElementById('exam-title');
       
        // Modal elements
        const resultModal = document.getElementById('result-modal');
        const modalScore = document.getElementById('modal-score');
        const modalStudentName = document.getElementById('modal-student-name');
        const modalClass = document.getElementById('modal-class');
        const modalSubject = document.getElementById('modal-subject');
        const modalTerm = document.getElementById('modal-term');
        const modalSession = document.getElementById('modal-session');
        const modalTimeTaken = document.getElementById('modal-time-taken');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const modalResultBtn = document.getElementById('modal-result-btn');

        // Exam state
        let currentQuestionIndex = 0;
        let userAnswers = {};
        let timerInterval;
        let timeRemaining = 0;
        let examStartTime = 0;
        let examData = null;

        // Student information
        const studentData = {
            name: "John Doe",
            regNo: "JSS1/2023/001",
            image: "IMG/student.jpg"
        };

        // Default exam data in case JSON fetch fails
        const defaultExamData = {
            subject: "Mathematics",
            class: "JSS1",
            term: "First Term",
            time: 60,
            session: "2023/2024",
            questions: [
                {
                    id: 1,
                    question: "What is the value of 5 + 7?",
                    options: {
                        a: "10",
                        b: "11",
                        c: "12",
                        d: "13"
                    },
                    answer: "c",
                    image: null
                },
                {
                    id: 2,
                    question: "If a rectangle has length 8cm and width 5cm, what is its area?",
                    options: {
                        a: "13 cm²",
                        b: "26 cm²",
                        c: "40 cm²",
                        d: "45 cm²"
                    },
                    answer: "c",
                    image: null
                },
                {
                    id: 3,
                    question: "Simplify: 3/4 + 1/2",
                    options: {
                        a: "4/6",
                        b: "5/4",
                        c: "1 1/4",
                        d: "1 1/2"
                    },
                    answer: "b",
                    image: null
                },
                {
                    id: 4,
                    question: "What is the square root of 144?",
                    options: {
                        a: "11",
                        b: "12",
                        c: "13",
                        d: "14"
                    },
                    answer: "b",
                    image: null
                },
                {
                    id: 5,
                    question: "If x + 5 = 12, what is the value of x?",
                    options: {
                        a: "5",
                        b: "6",
                        c: "7",
                        d: "8"
                    },
                    answer: "c",
                    image: null
                },
                {
                    id: 6,
                    question: "Calculate the perimeter of a square with side 6cm.",
                    options: {
                        a: "12 cm",
                        b: "18 cm",
                        c: "24 cm",
                        d: "36 cm"
                    },
                    answer: "c",
                    image: null
                },
                {
                    id: 7,
                    question: "What is 25% of 200?",
                    options: {
                        a: "25",
                        b: "50",
                        c: "75",
                        d: "100"
                    },
                    answer: "b",
                    image: null
                },
                {
                    id: 8,
                    question: "Solve: 2x - 5 = 11",
                    options: {
                        a: "x = 3",
                        b: "x = 6",
                        c: "x = 8",
                        d: "x = 13"
                    },
                    answer: "c",
                    image: null
                },
                {
                    id: 9,
                    question: "What is the product of 9 and 7?",
                    options: {
                        a: "56",
                        b: "63",
                        c: "72",
                        d: "81"
                    },
                    answer: "b",
                    image: null
                },
                {
                    id: 10,
                    question: "If a triangle has base 10cm and height 6cm, what is its area?",
                    options: {
                        a: "16 cm²",
                        b: "30 cm²",
                        c: "60 cm²",
                        d: "120 cm²"
                    },
                    answer: "b",
                    image: null
                }
            ]
        };

        // Fetch exam data from JSON file
        async function fetchExamData() {
            try {
                console.log('Fetching exam data...');
                const response = await fetch('jss1_mathematics_objectives.json');
               
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
               
                const data = await response.json();
                console.log('Exam data fetched successfully:', data);
               
                // Validate the data structure
                if (!data.questions || !Array.isArray(data.questions) || data.questions.length === 0) {
                    throw new Error('Invalid exam data structure: questions array is missing or empty');
                }
               
                return data;
            } catch (error) {
                console.error('Error fetching exam data:', error);
                console.log('Using default exam data instead');
                // Return default data if fetch fails
                return defaultExamData;
            }
        }

        // Initialize exam
        async function initExam() {
            try {
                // Show loading state
                const loadingDiv = document.createElement('div');
                loadingDiv.className = 'loading';
                loadingDiv.textContent = 'Loading exam questions...';
                document.body.appendChild(loadingDiv);
               
                // Fetch exam data
                examData = await fetchExamData();
               
                // Remove loading state
                document.body.removeChild(loadingDiv);
               
                // Set exam info from JSON data
                classInfo.textContent = examData.class;
                subjectInfo.textContent = examData.subject;
                termInfo.textContent = examData.term;
                sessionInfo.textContent = examData.session;
                totalQuestions.textContent = examData.questions.length;
               
                // Set student info
                studentName.textContent = studentData.name;
                document.getElementById('reg-no').textContent = studentData.regNo;
                studentImg.src = studentData.image;
               
                // Set exam title
                examTitle.textContent = `${examData.class} ${examData.subject.toUpperCase()} EXAMINATION`;
               
                // Initialize user answers
                examData.questions.forEach(question => {
                    userAnswers[question.id] = null;
                });
               
                // Create question navigation buttons
                createQuestionGrid();
               
                // Display first question
                displayQuestion(currentQuestionIndex);
               
                // Update question counters
                updateQuestionCounters();
               
                // Set timer
                timeRemaining = examData.time * 60; // Convert to seconds
                examStartTime = Date.now();
               
                // Start timer
                startTimer();
            } catch (error) {
                console.error('Error initializing exam:', error);
                // Show error message
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error';
                errorDiv.innerHTML = `
                    <h2>Error Loading Exam</h2>
                    <p>Failed to load exam data. Please try again later.</p>
                    <p><small>Error: ${error.message}</small></p>
                    <button onclick="location.reload()" class="btn" style="margin-top: 10px;">Retry</button>
                `;
                document.body.innerHTML = '';
                document.body.appendChild(errorDiv);
            }
        }

        // Create question navigation grid
        function createQuestionGrid() {
            examData.questions.forEach((question, index) => {
                const button = document.createElement('button');
                button.className = 'question-btn';
                button.textContent = index + 1;
                button.addEventListener('click', () => {
                    currentQuestionIndex = index;
                    displayQuestion(currentQuestionIndex);
                });
                questionGrid.appendChild(button);
            });
        }

        // Display question
        function displayQuestion(index) {
            const question = examData.questions[index];
           
            // Update current question display
            currentQuestion.textContent = index + 1;
           
            // Display question text
            questionText.textContent = question.question;
           
            // Display question image if available
            if (question.image) {
                questionImage.src = question.image;
                questionImage.style.display = 'block';
            } else {
                questionImage.style.display = 'none';
            }
           
            // Display options
            optionsContainer.innerHTML = '';
            for (const [key, value] of Object.entries(question.options)) {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                if (userAnswers[question.id] === key) {
                    optionDiv.classList.add('selected');
                }
                optionDiv.innerHTML = `<strong>${key.toUpperCase()}.</strong> ${value}`;
                optionDiv.addEventListener('click', () => selectOption(question.id, key));
                optionsContainer.appendChild(optionDiv);
            }
           
            // Update navigation buttons
            updateNavigationButtons();
           
            // Update question grid highlighting
            updateQuestionGrid();
           
            // Update HTML editor
            updateHtmlEditor();
        }

        // Select an option
        function selectOption(questionId, option) {
            userAnswers[questionId] = option;
            displayQuestion(currentQuestionIndex);
            updateQuestionCounters();
        }

        // Update navigation buttons
        function updateNavigationButtons() {
            // Previous button
            if (currentQuestionIndex === 0) {
                prevBtn.disabled = true;
                prevBtn.style.opacity = '0.5';
            } else {
                prevBtn.disabled = false;
                prevBtn.style.opacity = '1';
            }
           
            // Next button
            if (currentQuestionIndex === examData.questions.length - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'inline-block';
            } else {
                nextBtn.style.display = 'inline-block';
                submitBtn.style.display = 'none';
            }
        }

        // Update question counters
        function updateQuestionCounters() {
            const answered = Object.values(userAnswers).filter(answer => answer !== null).length;
            const unanswered = examData.questions.length - answered;
           
            answeredCount.textContent = answered;
            unansweredCount.textContent = unanswered;
        }

        // Update question grid highlighting
        function updateQuestionGrid() {
            const buttons = questionGrid.querySelectorAll('.question-btn');
            buttons.forEach((button, index) => {
                button.classList.remove('answered', 'current');
               
                const questionId = examData.questions[index].id;
                if (userAnswers[questionId] !== null) {
                    button.classList.add('answered');
                }
               
                if (index === currentQuestionIndex) {
                    button.classList.add('current');
                }
            });
        }

        // Update HTML editor
        function updateHtmlEditor() {
            const question = examData.questions[currentQuestionIndex];
            let htmlCode = `&lt;div class="question-number"&gt;Question ${currentQuestionIndex + 1}&lt;/div&gt;\n`;
            htmlCode += `&lt;div class="question-text"&gt;${question.question}&lt;/div&gt;\n`;
           
            if (question.image) {
                htmlCode += `&lt;img class="question-image" src="${question.image}" alt="Question Image"&gt;\n`;
            }
           
            htmlCode += `&lt;div class="options"&gt;\n`;
            for (const [key, value] of Object.entries(question.options)) {
                const isSelected = userAnswers[question.id] === key;
                const selectedClass = isSelected ? ' selected' : '';
                htmlCode += `  &lt;div class="option${selectedClass}"&gt;&lt;strong&gt;${key.toUpperCase()}.&lt;/strong&gt; ${value}&lt;/div&gt;\n`;
            }
            htmlCode += `&lt;/div&gt;`;
           
            htmlEditor.innerHTML = htmlCode;
        }

        // Start timer
        function startTimer() {
            updateTimerDisplay();
           
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
               
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    submitExam();
                }
            }, 1000);
        }

        // Update timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            timeDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
           
            // Change color when time is running out
            if (timeRemaining < 300) { // 5 minutes
                timeDisplay.style.color = '#e74c3c';
            }
        }

        // Calculate score
        function calculateScore() {
            let score = 0;
            examData.questions.forEach(question => {
                if (userAnswers[question.id] === question.answer) {
                    score++;
                }
            });
            return score;
        }

        // Calculate time taken
        function calculateTimeTaken() {
            const timeTaken = Math.max(0, examData.time * 60 - timeRemaining);
            const minutes = Math.floor(timeTaken / 60);
            const seconds = timeTaken % 60;
            return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Submit exam
        function submitExam() {
            clearInterval(timerInterval);
           
            // Calculate score
            const score = calculateScore();
            const totalQuestions = examData.questions.length;
           
            // Calculate time taken
            const timeTaken = calculateTimeTaken();
           
            // Show modal with results
            showResultModal(score, totalQuestions, timeTaken);
        }

        // Show result modal
        function showResultModal(score, total, timeTaken) {
            modalScore.textContent = `${score}/${total}`;
            modalStudentName.textContent = studentData.name;
            modalClass.textContent = examData.class;
            modalSubject.textContent = examData.subject;
            modalTerm.textContent = examData.term;
            modalSession.textContent = examData.session;
            modalTimeTaken.textContent = timeTaken;
           
            resultModal.style.display = 'flex';
        }

        // Redirect to results page
        function redirectToResultsPage(score, total, timeTaken) {
            // Store results in sessionStorage to pass to the results page
            const results = {
                score: score,
                total: total,
                studentName: studentData.name,
                className: examData.class,
                subject: examData.subject,
                term: examData.term,
                session: examData.session,
                timeTaken: timeTaken,
                answers: userAnswers,
                questions: examData.questions
            };
           
            sessionStorage.setItem('examResults', JSON.stringify(results));
            window.location.href = 'results.html';
        }

        // Event listeners
        prevBtn.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion(currentQuestionIndex);
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentQuestionIndex < examData.questions.length - 1) {
                currentQuestionIndex++;
                displayQuestion(currentQuestionIndex);
            }
        });

        submitBtn.addEventListener('click', submitExam);

        toggleEditor.addEventListener('click', () => {
            if (htmlEditor.style.display === 'none' || htmlEditor.style.display === '') {
                htmlEditor.style.display = 'block';
                toggleEditor.textContent = 'Hide HTML Code';
            } else {
                htmlEditor.style.display = 'none';
                toggleEditor.textContent = 'Show HTML Code';
            }
        });

        // Modal event listeners
        modalCloseBtn.addEventListener('click', () => {
            resultModal.style.display = 'none';
        });

        modalResultBtn.addEventListener('click', () => {
            const score = calculateScore();
            const total = examData.questions.length;
            const timeTaken = calculateTimeTaken();
            redirectToResultsPage(score, total, timeTaken);
        });

        // Close modal when clicking outside
        window.addEventListener('click', (event) => {
            if (event.target === resultModal) {
                resultModal.style.display = 'none';
            }
        });

        // Initialize the exam when page loads
        window.addEventListener('load', initExam);
    </script>
</body>
</html>
